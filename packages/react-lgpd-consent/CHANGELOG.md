# Changelog

Todas as mudan√ßas not√°veis neste projeto ser√£o documentadas neste arquivo.

# Changelog

Todas as mudan√ßas not√°veis neste projeto ser√£o documentadas neste arquivo.

O formato √© baseado em [Keep a Changelog](https://keepachangelog.com/pt-BR/1.0.0/),
e este projeto adere ao [Semantic Versioning](https://semver.org/lang/pt-BR/).

## [0.5.0] - 2025-10-25

### üèóÔ∏è Arquitetura Modular - MAJOR REFACTOR

Esta vers√£o introduz uma **arquitetura modular** que separa a l√≥gica de consentimento (core) dos componentes UI (mui).

### ‚ú® Added

- **Tr√™s pacotes independentes**:
  - `@react-lgpd-consent/core` (86 KB ESM) - L√≥gica headless sem depend√™ncias de UI
  - `@react-lgpd-consent/mui` (18 KB ESM) - Componentes UI completos usando Material-UI
  - `react-lgpd-consent` (104 KB ESM) - Pacote agregador mantido para compatibilidade

- **Tree-shaking eficiente**: Instale apenas o que voc√™ precisa
  - Core isolado permite uso com qualquer biblioteca de UI
  - MUI opcional como peer dependency
  
- **Workspace PNPM**: Monorepo organizado com builds independentes
- **Guia de migra√ß√£o completo**: [MIGRATION.md](../../MIGRATION.md) documentando todos os cen√°rios
- **Scripts de publica√ß√£o**: Suporte para publicar pacotes independentemente

### ‚ö†Ô∏è Breaking Changes

- **Removida prop `theme` do `ConsentProvider`**
  - **Antes**: `<ConsentProvider theme={createTheme({...})} />`
  - **Depois**: Use `<ThemeProvider>` do Material-UI diretamente
  - **Raz√£o**: Separa√ß√£o de responsabilidades - tema do MUI gerenciado pelo MUI
  - **Migra√ß√£o**: Ver [MIGRATION.md](../../MIGRATION.md) se√ß√£o "Breaking Changes"

### üîÑ Changed

- Estrutura de pacotes reorganizada em monorepo
- Imports atualizados para usar workspace dependencies
- TypeScript paths configurados para resolu√ß√£o de m√≥dulos
- Jest configurado para resolver tsconfig corretamente
- Stories refatoradas para usar `ThemeProvider` explicitamente

### üì¶ Package Structure

```
packages/
‚îú‚îÄ‚îÄ core/           # @react-lgpd-consent/core
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context/     # ConsentProvider, CategoriesContext
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/       # useConsent, useCategories
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/       # scriptIntegrations, logger
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/       # TypeScript definitions
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ mui/            # @react-lgpd-consent/mui
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/  # CookieBanner, PreferencesModal, etc.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts     # Re-exports core + UI components
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îî‚îÄ‚îÄ react-lgpd-consent/  # Aggregator (compatibilidade)
    ‚îî‚îÄ‚îÄ package.json     # Re-exports @react-lgpd-consent/mui
```

### üìä Bundle Sizes

| Pacote | ESM | CJS | DTS | Depend√™ncias |
|--------|-----|-----|-----|--------------|
| `@react-lgpd-consent/core` | 86.04 KB | 89.12 KB | 125.82 KB | React, js-cookie, zod |
| `@react-lgpd-consent/mui` | 17.69 KB | 20.95 KB | 11.78 KB | core + @mui/material (peer) |
| `react-lgpd-consent` | 104 KB* | 110 KB* | 138 KB* | mui (workspace) |

\* Bundle final = core + mui (~104 KB total)

### üéØ Migration Paths

1. **Uso de componentes UI** (maioria dos usu√°rios):
   ```bash
   # Op√ß√£o A: Pacote agregador (zero mudan√ßas)
   npm install react-lgpd-consent@0.5.0
   
   # Op√ß√£o B: Pacote MUI direto (recomendado)
   npm install @react-lgpd-consent/mui
   ```

2. **Headless/UI customizada**:
   ```bash
   npm uninstall react-lgpd-consent @mui/material
   npm install @react-lgpd-consent/core
   ```

3. **NextJS App Router**:
   ```tsx
   // Separa√ß√£o clara client/server
   'use client'
   import { ConsentProvider } from '@react-lgpd-consent/mui'
   ```

### ‚úÖ Maintained (Sem Breaking Changes)

- Todas as APIs p√∫blicas do `useConsent`
- Props de `ConsentProvider` (exceto `theme`)
- Componentes `CookieBanner`, `PreferencesModal`, `FloatingPreferencesButton`
- Sistema de textos e templates (`TEXT_TEMPLATES`, `resolveTexts`)
- Sistema de design tokens (`designTokens`)
- Integra√ß√µes (Google Analytics, GTM, UserWay, etc.)
- SSR/NextJS support
- TypeScript types completos

### üîß Fixed

- Jest configura√ß√£o: tsconfig path resolution
- Stories: uso correto de ThemeProvider
- Type-check: todos os pacotes passam sem erros
- Tests: 207 testes passando em todos os pacotes

### üìö Documentation

- Novo [MIGRATION.md](../../MIGRATION.md) com:
  - 3 cen√°rios de migra√ß√£o detalhados
  - Comparativo de bundles
  - Troubleshooting completo
  - Exemplos antes/depois
- README atualizado com:
  - 3 op√ß√µes de instala√ß√£o
  - Comparativo de pacotes
  - Guia de escolha
- READMEs espec√≠ficos para core e mui packages

### üöÄ Development

- PNPM workspaces configurados
- Scripts: `build:core`, `build:mui`, `build:main`
- Scripts: `publish:core`, `publish:mui`, `publish:main`, `publish:all`
- Type-check executado em todos os pacotes
- Tests executados em todos os pacotes
- Node >= 20.0.0 requerido

---

## [0.4.5] - 2025-10-25 ‚Äî DataLayer Events e CI/CD

### üìä **DataLayer Events para Google Tag Manager**

- **Eventos Padronizados**: Implementado contrato de eventos `consent_initialized` e `consent_updated` no `window.dataLayer`
  - `consent_initialized`: Disparado ap√≥s hidrata√ß√£o inicial do `ConsentProvider`
  - `consent_updated`: Disparado quando usu√°rio altera prefer√™ncias via banner, modal ou API
  - Payload inclui: `event`, `consent_version`, `timestamp` (ISO 8601), `categories`, `origin`, `changed_categories`
  
- **Rastreamento de Origem**: Campo `origin` identifica fonte da mudan√ßa de consentimento
  - `'banner'`: Decis√£o feita no CookieBanner
  - `'modal'`: Ajuste feito no PreferencesModal
  - `'reset'`: Reset program√°tico via API
  - `'programmatic'`: Mudan√ßa via `setPreference()` ou `acceptAll()`

- **API P√∫blica**: Novas fun√ß√µes exportadas para uso customizado
  - `pushConsentInitializedEvent(categories: ConsentPreferences)`
  - `pushConsentUpdatedEvent(categories: ConsentPreferences, origin: ConsentEventOrigin, previousCategories?: ConsentPreferences)`
  - Tipos: `ConsentEventOrigin`, `ConsentInitializedEvent`, `ConsentUpdatedEvent`, `ConsentEvent`

- **Integra√ß√£o Autom√°tica**: Eventos disparados automaticamente pelo `ConsentContext`
  - Ref `previousPreferencesRef` rastreia estado anterior para calcular `changed_categories`
  - Logger integrado para debug de eventos em desenvolvimento
  - SSR-safe: n√£o quebra quando `window` √© undefined

- **Documenta√ß√£o GTM**: Se√ß√£o completa adicionada em `INTEGRACOES.md`
  - Schemas dos eventos com exemplos
  - Passo a passo de configura√ß√£o do Google Tag Manager
  - Exemplos TypeScript de triggers e tags customizados
  - Casos de uso: auditoria LGPD, an√°lise de convers√£o, triggers condicionais

### üîß **CI/CD e Build**

- **Migra√ß√£o para pnpm**: Workflows atualizados de npm para pnpm
  - `ci.yml`: Adicionado `pnpm/action-setup@v4`, substitu√≠do `npm ci` por `pnpm install --frozen-lockfile`
  - `package-check.yml`: Migrado para pnpm
  - `publish-github-packages.yml`: Migrado para pnpm
  - `deploy-docs.yml`: Migrado para pnpm
  - **Problema Resolvido**: Conflitos `ERESOLVE` com `@eslint/js` eliminados
  - `.gitignore`: Adicionado `package-lock.json` para evitar conflitos

- **Depend√™ncias**: Adicionado `@eslint/js@9.38.0` para resolver missing dependency error

### üß™ **Testes**

- **dataLayerEvents.test.ts**: 10 novos testes cobrindo eventos dataLayer
  - Push de eventos `consent_initialized` e `consent_updated`
  - C√°lculo correto de `changed_categories`
  - Diferentes origens (banner, modal, reset, programmatic)
  - Inicializa√ß√£o do dataLayer se n√£o existir
  - SSR-safety (n√£o quebra quando window √© undefined)
  - Formato ISO 8601 de timestamps
  - **Solu√ß√£o de Isolamento**: Testes usam estrat√©gia de "pegar √∫ltimo evento" para evitar ac√∫mulo entre testes

### üìö **Documenta√ß√£o**

- **INTEGRACOES.md**: Nova se√ß√£o "Eventos dataLayer (Google Tag Manager)" com 200+ linhas
- **README.md**: Se√ß√£o "Novidades v0.4.5" com resumo de features
- **README.en.md**: Tradu√ß√£o da se√ß√£o "What's New in v0.4.5"
- **tsconfig.typedoc.json**: Corrigido para excluir `*.test.ts` (al√©m de `*.test.tsx`)
- **API P√∫blica**: Exporta√ß√µes documentadas com TSDoc completo

### üì¶ **Build**

- **Vers√£o**: Bump de `0.4.4` ‚Üí `0.4.5`
- **Tamanho**: Build otimizado mant√©m tree-shaking e SSR-safety
  - ESM: `dist/index.js` ~32.59 KB
  - CJS: `dist/index.cjs` ~38.17 KB
  - Types: `dist/index.d.ts` ~132.13 KB

---

## [0.4.4] - 2025-10-06 ‚Äî Corre√ß√µes de CI/CD e Publica√ß√£o

### üîß **Corre√ß√µes de CI/CD**

- **Workflow de Publica√ß√£o npm**: Corrigido bug que impedia publica√ß√£o mesmo quando tag estava na `main`
  - **Problema**: `git fetch --depth=1` limitava hist√≥rico e falhava verifica√ß√£o de ancestralidade
  - **Solu√ß√£o**: Removido `--depth=1` do fetch, aproveitando `fetch-depth: 0` do checkout
  - **Impacto**: Tags criadas ap√≥s merge para `main` agora s√£o publicadas corretamente no npm

### üìä **Integra√ß√£o com Codecov**

- **Upload de Coverage**: Adicionado `codecov/codecov-action@v5` ao workflow CI
  - Envia relat√≥rios de cobertura automaticamente para Codecov
  - Token configurado via `secrets.CODECOV_TOKEN`
  - Integra√ß√£o com badge de coverage no README

### üìö **Documenta√ß√£o**

- **Badges**: Badge de coverage j√° configurado no README (v0.4.3) agora recebe dados em tempo real
- **Workflows**: Documenta√ß√£o inline sobre fetch depth e verifica√ß√£o de ancestralidade

## [0.4.3] - 2025-10-06 ‚Äî Otimiza√ß√µes de Performance e Qualidade

### üöÄ **Melhorias de Performance**

- **React.memo**: Adicionado memoiza√ß√£o em componentes puros (`Branding`, `FloatingPreferencesButton`)
- **useMemo**: Otimizado c√°lculo de `positionStyles` no `FloatingPreferencesButton`
- **Lazy Loading Expandido**: `FloatingPreferencesButton` agora √© carregado sob demanda
- **Logger em Produ√ß√£o**: `warn()`, `info()`, `debug()` suprimidos em `NODE_ENV=production`
  - Reduz overhead em bundle de produ√ß√£o
  - `error()` permanece ativo para debugging cr√≠tico

### üêõ **Corre√ß√µes Cr√≠ticas**

- **ConsentProvider Suspense Bug**: Corrigido crash silencioso quando `consented=true`
  - Adicionado `<React.Suspense>` ausente ao redor do `FloatingPreferencesButton` lazy
  - Sintoma: Provider renderizava `<div />` vazio ao inv√©s de `children`
  - Impacto: Testes com `initialState.consented=true` agora passam

### üß™ **Testes de Acessibilidade (A11y)**

- **jest-axe**: Integra√ß√£o completa com valida√ß√£o WCAG autom√°tica
- **CookieBanner.a11y.test.tsx**: 3 cen√°rios de acessibilidade validados
- **PreferencesModal.a11y.test.tsx**: 3 cen√°rios de acessibilidade validados
- **TypeScript**: Defini√ß√µes `jest-axe.d.ts` para matcher `toHaveNoViolations()`
- **Script**: Adicionado `npm run test:a11y` para testes focados

### üì¶ **Exports Modulares**

- **`./integrations`**: Novo export separado para tree-shaking otimizado
  - Permite `import { createGoogleAnalyticsIntegration } from 'react-lgpd-consent/integrations'`
  - Reduz bundle para consumidores que n√£o usam integra√ß√µes
  - Suporte ESM + CJS + TypeScript definitions

### üîß **CI/CD**

- **Node.js 20**: Atualizado de Node 18 para Node 20 LTS em todos os workflows
- **Cache TypeScript**: Adicionado cache de builds para acelerar CI (~20% mais r√°pido)
  - Cache de `.tsbuildinfo`, `node_modules/.cache`, `.eslintcache`
  - Workflows atualizados: `ci.yml`, `codeql.yml`, `deploy-docs.yml`, `package-check.yml`

### üìö **Documenta√ß√£o**

- **Badges**: Adicionados 3 badges ao README (Coverage, Bundle Size, Node Version)
  - Codecov para visualiza√ß√£o de cobertura
  - Bundlephobia para tamanho de bundle
  - Node.js badge para requisitos de ambiente

### ‚úÖ **Valida√ß√£o de Qualidade**

- **222 testes passando**: 100% de sucesso sem skips
- **94.85% cobertura**: Mantida cobertura alta
- **0 warnings de lint**: ESLint limpo
- **Build otimizado**: ESM 32.52 KB + lazy chunks (95B + 86B)

### üì¶ **Otimiza√ß√µes de Bundle**

- **tsup.config.ts**: Configura√ß√£o otimizada para tree-shaking e code-splitting
- **ESM Bundle**: 33.26 KB ‚Üí 32.52 KB (-740B, -2.2%)
- **CJS Bundle**: 118.51 KB ‚Üí 37.71 KB (CJS principal) + chunks (-68%, muito mais eficiente!)
- **Brotli Compressed**:
  - ESM: 17.06 KB ‚Üí 16.95 KB (-110B)
  - CJS: 68.72 KB ‚Üí 18.02 KB (-74%, -50.7 KB!)
- **Side-effects**: Configura√ß√£o refinada para preservar code-splitting sem warnings
- **Tree-shaking**: Agressivo com external de peer dependencies

### üéØ **Decis√µes de Design**

- **ConsentGate n√£o usa memo**: Decis√£o intencional - estado de prefer√™ncias √© din√¢mico
  - Re-renders necess√°rios quando usu√°rio altera consentimento
  - L√≥gica leve o suficiente para n√£o justificar memoiza√ß√£o

### üìã **Depend√™ncias**

- **Adicionadas**:
  - `@axe-core/react@^4.10.2` (dev)
  - `jest-axe@^10.0.0` (dev)
  - `@types/jest-axe@^3.5.9` (dev)

## [0.4.1] - 2025-09-21 ‚Äî Expans√£o das Integra√ß√µes Nativas de Scripts

### üöÄ **Integra√ß√µes Nativas Expandidas**

- **Facebook Pixel**: `createFacebookPixelIntegration()` com auto-tracking e advanced matching
- **Hotjar**: `createHotjarIntegration()` para heatmaps e session recordings
- **Mixpanel**: `createMixpanelIntegration()` com configura√ß√£o avan√ßada de eventos
- **Microsoft Clarity**: `createClarityIntegration()` para analytics de comportamento
- **Intercom**: `createIntercomIntegration()` para chat e suporte ao cliente
- **Zendesk Chat**: `createZendeskChatIntegration()` para atendimento integrado
- **Drift**: `createDriftIntegration()` para conversational marketing
- **Freshchat**: `createFreshchatIntegration()` para customer support

### üéØ **Sistema de Configura√ß√£o em Lote**

- **Templates de neg√≥cio**: `createECommerceIntegrations()`, `createSaaSIntegrations()`, `createCorporateIntegrations()`
- **Categoriza√ß√£o inteligente**: `suggestCategoryForScript()` para sugest√£o autom√°tica de categorias
- **Configura√ß√£o unificada**: Setup simplificado para m√∫ltiplas ferramentas com um comando
- **Padr√µes de mercado**: Templates baseados em necessidades reais do mercado brasileiro

### üîß **Melhorias no Sistema de Scripts**

- **Valida√ß√£o robusta**: `validateNecessaryClassification()` corrigida para evitar falsos positivos
- **Auto-configura√ß√£o**: `autoConfigureCategories()` com detec√ß√£o inteligente de categorias necess√°rias
- **Error handling**: Melhor tratamento de erros em carregamento de scripts
- **Performance**: Carregamento otimizado e lazy loading de integra√ß√µes

### üîç **Descoberta Autom√°tica de Cookies (Experimental)**

- **discoverRuntimeCookies()**: Escaneamento de cookies em tempo real no navegador
- **detectConsentCookieName()**: Detec√ß√£o autom√°tica do cookie de consentimento
- **categorizeDiscoveredCookies()**: Categoriza√ß√£o inteligente usando padr√µes LGPD
- **Integra√ß√£o nativa**: Suporte a `setCookieCatalogOverrides` autom√°tico
- **SSR-safe**: Funciona corretamente em ambientes server-side rendering

### üé® **Design Tokens Expandidos**

- **200+ pontos de customiza√ß√£o**: Expans√£o dram√°tica do sistema de design tokens
- **Sistema responsivo**: Breakpoints, spacing responsivo, typography hierarchy
- **Acessibilidade nativa**: Contrast ratios, focus states, motion preferences
- **Tokens por componente**: Customiza√ß√£o granular para cada elemento UI

### üìù **Sistema Avan√ßado de Textos**

- **Templates pr√©-configurados**: Ecommerce, SaaS, Governo com contextos espec√≠ficos
- **Multilingual**: Portugu√™s, ingl√™s, espanhol com fallbacks inteligentes
- **Fun√ß√£o resolveTexts**: Resolu√ß√£o autom√°tica de textos baseada em contexto

### üß™ **Melhorias de Testes e Qualidade**

- **193 testes passando**: Cobertura substancialmente melhorada
- **19 novos testes**: Especificamente para `cookieRegistry` (antes 45.83% ‚Üí 100% branches)
- **Test realism**: Testes adaptados ao comportamento real vs ideal
- **Edge cases**: Performance, boundary testing, state management
- **Lint compliance**: Configura√ß√£o ESLint mais rigorosa e aderente

### üîß **Melhorias de API e Developer Experience**

- **Exports organizados**: Melhor estrutura√ß√£o das exporta√ß√µes p√∫blicas
- **TypeScript strict**: Tipagem mais rigorosa e descritiva
- **Documenta√ß√£o TSDoc**: Coment√°rios expandidos com exemplos pr√°ticos
- **Error handling**: Tratamento de erros mais robusto e informativo
- **Performance**: Otimiza√ß√µes em carregamento e renderiza√ß√£o

### üìö **Exemplos e Migra√ß√£o**

- **MigrationDemo-v0.4.1.tsx**: Exemplo completo mostrando todas as novidades
- **Remo√ß√£o**: TestV0.3.1.tsx removido (obsoleto)
- **Compatibilidade**: Guias de migra√ß√£o antes/depois
- **Best practices**: Demonstra√ß√µes de uso avan√ßado

### üèóÔ∏è **Build e Infraestrutura**

- **Bundle otimizado**: ESM 34.36 KB, CJS 102.74 KB
- **Tree-shaking**: Configura√ß√£o `sideEffects: false` otimizada
- **Docs geradas**: TypeDoc atualizado com novas funcionalidades
- **Pipeline robusto**: Type-check + tests + lint + build + docs

### ‚ö†Ô∏è **Breaking Changes**

#### üîß **`setPreference` Type Change**

- **Mudan√ßa**: `setPreference(cat: Category, value: boolean)` ‚Üí `setPreference(cat: string, value: boolean)`
- **Motivo**: Suporte a categorias customizadas al√©m das predefinidas
- **Impacto**: C√≥digo TypeScript com tipo `Category` expl√≠cito pode precisar ajustes
- **Migra√ß√£o**:
  - ‚úÖ **Nenhuma mudan√ßa necess√°ria** se usando strings literais (`'analytics'`, `'marketing'`)
  - ‚ö†Ô∏è **Ajuste necess√°rio** apenas se estava usando explicitamente o tipo `Category`
  - üìö **Guia**: Use `string` para suportar categorias customizadas ou continue usando os valores padr√£o

#### üîß **`ScriptIntegration.category` Type Change**

- **Mudan√ßa**: `category: Category` ‚Üí `category: string`
- **Motivo**: Suporte a categorias customizadas nas integra√ß√µes de script
- **Impacto**: Integra√ß√µes customizadas com tipo `Category` expl√≠cito
- **Migra√ß√£o**: Mesmas diretrizes do `setPreference` acima

### üéØ **Categorias Suportadas**

- `necessary` (sempre ativo)
- `analytics` (Google Analytics, etc.)
- `marketing` (Facebook Pixel, Google Ads)
- `functional` (Chat, mapas, widgets)
- `social` (Redes sociais, compartilhamento)
- `personalization` (Prefer√™ncias, customiza√ß√£o)

### üìà **Estat√≠sticas de Melhoria**

- **Design Tokens**: 4 ‚Üí 200+ pontos de customiza√ß√£o (+4900%)
- **Testes**: 174 ‚Üí 193 testes (+11% cobertura)
- **Funcionalidades**: +15 novas fun√ß√µes exportadas
- **Documenta√ß√£o**: +3 templates de texto, +6 contextos espec√≠ficos
- **Developer APIs**: +8 utilit√°rios para descoberta de cookies

## [0.4.0] - 2025-09-09 ‚Äî Custom categories

### Added

- Support for `customCategories` in `ConsentProvider.categories`.
  - Included in preferences initialization and validation.
  - Shown in the Preferences modal (with name/description).
  - Exposed via developer guidance/context for custom UIs.
- Quickstart PT/EN sections with `customCategories` examples.
- Storybook story: WithCustomCategories.

### Notes

- Non-breaking change; existing configurations continue to work.

## [0.3.7] - 2025-09-08 - Testes de UI e carregamento de scripts

### üß™ Novos testes e cobertura

- CookieBanner
  - Testes para renderiza√ß√£o condicional em modos bloqueante (overlay) e n√£o-bloqueante (Snackbar)
  - Verifica√ß√£o de abertura do modal ao clicar em ‚ÄúPrefer√™ncias‚Äù e persist√™ncia ao clicar em ‚ÄúRecusar‚Äù
- ConsentScriptLoader / Hook
  - Gating por consentimento e categoria; n√£o carrega scripts quando n√£o consentido ou categoria desabilitada
  - Tratamento de erros (log `logger.error` quando `loadScript` rejeita)
  - `reloadOnChange` reexecuta o carregamento ao reabilitar a categoria; default n√£o recarrega
- Integra√ß√µes de script
  - Verifica√ß√£o de `attrs` em integra√ß√µes (GA define `async: 'true'`)

### üîß Interno

- Aumento da estabilidade para refatora√ß√µes futuras na camada de UI e utilit√°rios de carregamento.

## [0.3.6] - 2025-08-28 - Corre√ß√£o cr√≠tica: Heran√ßa de ThemeProvider

### ‚ú® Novas funcionalidades e melhorias

- Storybook
  - Adicionado e aprimorado suporte ao Storybook com controles (`args`/`argTypes`) para componentes-chave (`FloatingPreferencesButton`, `PreferencesModal`) e suporte a tema escuro nas hist√≥rias.
  - Isolamento entre stories via reset de estado (remo√ß√£o/limpeza de cookie entre stories) e ajustes em `.storybook/preview.tsx` para compatibilidade com Vite/ESM.

- ConsentProvider
  - `blockingStrategy` (opt-in) adicionado para permitir overlays de bloqueio controlados pelo provider.
  - Melhor encaminhamento de props: `floatingPreferencesButtonProps` agora s√£o repassadas corretamente quando o `FloatingPreferencesButton` √© instanciado automaticamente.

- Testes e qualidade
  - Su√≠te de testes ampliada: novos testes para `DesignContext`, `useConsent`, `CategoriesContext`, `ConsentScriptLoader`, `cookieUtils`, `scriptLoader`, `scriptIntegrations`, `SafeThemeProvider`, `logger`, `ConsentGate`, `PreferencesModal` e `FloatingPreferencesButton`.
  - Configura√ß√£o inicial de mutation testing com Stryker.
  - Setup de testes atualizado para suprimir logs do `developerGuidance` durante execu√ß√£o normal e permitir testes dedicados que verifiquem esses logs.

- Integra√ß√£o e DX
  - Quickstart PT/EN e melhorias no `README` para facilitar ado√ß√£o e contribui√ß√µes.
  - Notas de troubleshooting e documenta√ß√£o adicional sobre Storybook e integra√ß√£o de componentes.

### üêõ Corre√ß√µes importantes

- `FloatingPreferencesButton` ‚Äî props forward
  - Sintoma: props (`tooltip`, `hideWhenConsented`, etc.) n√£o eram aplicadas quando o bot√£o era renderizado automaticamente pelo `ConsentProvider`.
  - Solu√ß√£o: `ConsentProvider` agora encaminha `floatingPreferencesButtonProps` corretamente para o componente padr√£o. Stories atualizadas.

- Storybook fixes
  - Removidos arquivos `preview.ts` que continham JSX; migrado para `preview.tsx` e ajustadas exports para evitar erros com o bundler (esbuild/vite).

### üß™ Testes e estabilidade

- Cobertura e robustez
  - Adicionados testes que validam uso de hooks fora do `ConsentProvider` (erros esperados), hidrata√ß√£o a partir de cookie, callbacks (`onConsentGiven`, `onPreferencesSaved`) e fluxos de UI (abrir/fechar modal, accept/reject).
  - Ajustes no `jest.setup` e um `jest.console-setup.ts` para garantir suprimir logs antes da coleta de m√≥dulos, mantendo testes determin√≠sticos.

### üìö Documenta√ß√£o

- Quickstart & README
  - Novo Quickstart em PT/EN e simplifica√ß√µes no `README` com foco em `QUICKSTART`.
  - Documenta√ß√£o de uso do Storybook e troubleshooting adicionada em `docs`.

### üõ†Ô∏è Corre√ß√£o cr√≠tica

- **Corrigido:** A biblioteca n√£o deve criar ou impor um `ThemeProvider` global por si s√≥. O `ConsentProvider` agora herda o theme do app consumidor quando um `ThemeProvider` do MUI estiver presente. O Provider s√≥ envolver√° com `ThemeProvider` se a prop `theme` for explicitamente fornecida.
- **Motiva√ß√£o:** Evitar conflitos de contexto MUI/Emotion, regress√µes visuais e problemas em SSR causados por cria√ß√£o de tema no escopo de m√≥dulo.
- **Export:** `createDefaultConsentTheme()` foi adicionada como f√°brica para quem precisar de um fallback expl√≠cito. Mantemos tamb√©m um getter de compatibilidade (deprecated) `defaultConsentTheme()` que retorna uma nova inst√¢ncia quando chamada, evitando side-effects no import.
- **Compatibilidade:** Uso padr√£o continua igual ‚Äî se seu app j√° fornece um `ThemeProvider` o `ConsentProvider` usar√° o theme existente. Para quem precisa de um fallback expl√≠cito, passe `theme={createDefaultConsentTheme()}` ao `ConsentProvider`.

> Nota: originalmente essa corre√ß√£o foi marcada como v0.3.5; devido a conflito de publica√ß√£o a vers√£o foi bumpada localmente para v0.3.6 e a entrada foi gravada nesta release.

- Limpeza de arquivos redundantes e ajustes de ESLint/preview para Storybook.

### Commits representativos

- Testes e supress√£o de logs: `fce823a`, `333ce0a`, `a1eea7e`
- Storybook / docs: `8f8c388`, `6e09058`, `329682c`, `9b1d977`, `adf0d49`
- Provider features: `967d278` (blockingStrategy)
- Quickstart / README: `db03ae3`
- Depend√™ncias / chores: `27339e7`, `3b7fdba`, `11c3602`

## [0.3.1] - 2025-08-13 - CORRE√á√ïES DE PRODU√á√ÉO E MELHORIAS DE COMPATIBILIDADE

### üõ°Ô∏è **Corrigido - Critical Production Fixes**

#### A) Compatibilidade com ThemeProvider

- **Erro "Cannot read properties of undefined (reading 'duration')"**: Implementado sistema de fallbacks seguros para propriedades de tema MUI inexistentes ou indefinidas
- **Componentes internos n√£o renderizavam**: Adicionado `SafeThemeProvider` interno que garante compatibilidade com diferentes configura√ß√µes de ThemeProvider do usu√°rio
- **Conflitos de tema**: `FloatingPreferencesButton` e outros componentes agora usam `useThemeWithFallbacks()` para acessar propriedades de tema com valores padr√£o

#### B) API do FloatingPreferencesButton

- **"Element type is invalid: expected string but got object"**: Corrigido erro de renderiza√ß√£o no `FloatingPreferencesButton`
- **Falta de controle sobre bot√£o flutuante**: Adicionada prop `disableFloatingPreferencesButton?: boolean` no `ConsentProvider`
- **Sem API para abrir modal programaticamente**:
  - Novo hook `useOpenPreferencesModal()` para componentes React
  - Nova fun√ß√£o `openPreferencesModal()` para uso em JavaScript puro
  - Integra√ß√£o autom√°tica com sistema global para acesso fora do contexto React

#### C) Exports de TypeScript Ausentes

- Adicionados exports p√∫blicos para melhor Developer Experience:
  - `CustomCookieBannerProps` - para componentes de banner customizados
  - `CustomPreferencesModalProps` - para modal de prefer√™ncias customizado
  - `CustomFloatingPreferencesButtonProps` - para bot√£o flutuante customizado
  - `ConsentProviderProps` - para tipagem das props do provider principal

### ‚ú® **Novas Funcionalidades**

#### Sistema de Debug e Troubleshooting

- **`setDebugLogging(enabled: boolean, level?: LogLevel)`**: Fun√ß√£o para habilitar logs detalhados em produ√ß√£o quando necess√°rio
- **Logs autom√°ticos**: Sistema de logging que inclui:
  - Compatibilidade de tema (detection de propriedades MUI faltantes)
  - Mudan√ßas de estado de consentimento
  - Opera√ß√µes de cookie (leitura/escrita/remo√ß√£o)
  - Renderiza√ß√£o de componentes (props e estados)
  - Integra√ß√µes de scripts (carregamento/falhas)
  - Chamadas de API internas
- **Detec√ß√£o autom√°tica de ambiente**: Logs desabilitados automaticamente em produ√ß√£o, habilitados em desenvolvimento

#### API Melhorada para Controle Program√°tico

- **`useOpenPreferencesModal()`**: Hook que retorna fun√ß√£o para abrir modal de prefer√™ncias
- **`openPreferencesModal()`**: Fun√ß√£o utilit√°ria para acesso global (fora de componentes React)
- **Integra√ß√£o com AccessibilityDock**: Exemplos de uso em dock de acessibilidade customizado

### üìö **Documenta√ß√£o**

#### Guia de API v0.3.1+

- **Novo arquivo**: `docs/API-v0.3.1.md` com exemplos completos
- **Casos de uso**: Next.js 14+, Material-UI, componentes totalmente customizados
- **Troubleshooting**: Guia de resolu√ß√£o dos problemas mais comuns
- **Migration Guide**: Instru√ß√µes de atualiza√ß√£o (sem breaking changes)

#### Exemplos de Implementa√ß√£o

- **Componentes customizados**: Exemplos completos de `CustomCookieBanner`, `CustomPreferencesModal`
- **Integra√ß√£o com AccessibilityDock**: Implementa√ß√£o de bot√£o de prefer√™ncias em dock customizado
- **SSR/Next.js**: Configura√ß√£o para evitar flash de conte√∫do e hidrata√ß√£o adequada
- **Debug em produ√ß√£o**: Como habilitar logs para troubleshooting quando necess√°rio

### üîß **Melhorias T√©cnicas**

#### Robustez e Estabilidade

- **SafeThemeProvider**: Componente interno que evita erros de tema em diferentes configura√ß√µes de Material-UI
- **Fallbacks autom√°ticos**: Valores padr√£o para todas as propriedades de tema acessadas pelos componentes
- **Detec√ß√£o de ambiente**: Melhorada para funcionar em diferentes build systems e ambientes de execu√ß√£o
- **Compatibilidade**: Testado com Material-UI v5 e Next.js 14+

#### Developer Experience

- **Tipos mais precisos**: Exports de todos os tipos necess√°rios para customiza√ß√£o
- **Logs informativos**: Sistema de debug que facilita identifica√ß√£o de problemas
- **Documenta√ß√£o expandida**: Exemplos pr√°ticos e casos de uso reais
- **Zero breaking changes**: Atualiza√ß√£o segura desde v0.3.0

### üõ†Ô∏è **Contexto de Corre√ß√£o**

Estas corre√ß√µes abordam problemas identificados em produ√ß√£o com:

- **Apps Next.js 14+ usando Material-UI**: Conflitos de ThemeProvider resolvidos
- **Componentes customizados**: APIs claras para substitui√ß√£o completa da UI
- **AccessibilityDock integrations**: Controle program√°tico do modal de prefer√™ncias
- **Troubleshooting**: Sistema de logs para diagn√≥stico de problemas em produ√ß√£o

### üìã **Migration from v0.3.0**

‚úÖ **Zero Breaking Changes**: Atualiza√ß√£o direta sem modifica√ß√µes necess√°rias

**Novos recursos opcionais**:

```tsx
// Desabilitar bot√£o flutuante padr√£o
;<ConsentProvider
  disableFloatingPreferencesButton={true}
  // ... outras props
/>

// Usar controle program√°tico
const openModal = useOpenPreferencesModal()

// Habilitar debug se necess√°rio
setDebugLogging(true, LogLevel.DEBUG)
```

## [0.3.0] - 2025-08-12 - DX APRIMORADA E UI AUTOM√ÅTICA

### üö® **MUDAN√áAS QUE QUEBRAM A COMPATIBILIDADE**

- **Remo√ß√£o de Exports Diretos de Componentes UI**: `CookieBanner` e `FloatingPreferencesButton` n√£o s√£o mais exportados diretamente. Eles agora s√£o gerenciados e renderizados automaticamente pelo `ConsentProvider`.
- **Remo√ß√£o da Prop `disableAutomaticModal`**: Esta prop foi removida do `ConsentProvider`. O modal de prefer√™ncias agora √© sempre renderizado (seja o padr√£o ou um componente customizado fornecido) e sua visibilidade √© controlada internamente pelo estado `isModalOpen`.
- **Tipagem Estrita para Componentes UI Customizados**: As props para `PreferencesModalComponent`, `CookieBannerComponent` e `FloatingPreferencesButtonComponent` agora exigem tipos espec√≠ficos (`CustomPreferencesModalProps`, `CustomCookieBannerProps`, `CustomFloatingPreferencesButtonProps`). Componentes customizados que usavam `React.ComponentType<any>` precisar√£o ser atualizados.
- **Remo√ß√£o do Hook `useConsentComponentProps`**: Este hook utilit√°rio foi removido, pois os componentes internos agora usam `useConsent` e `useConsentTexts` diretamente.

### ‚ú® **Novas Funcionalidades e Melhorias**

- **Renderiza√ß√£o Autom√°tica de Componentes UI Padr√£o**: O `ConsentProvider` agora renderiza automaticamente o `CookieBanner` (quando necess√°rio) e o `FloatingPreferencesButton` (ap√≥s consentimento), reduzindo o boilerplate.
- **Componentes UI Sobrescrev√≠veis com Tipagem Clara**: Permite que desenvolvedores forne√ßam seus pr√≥prios componentes de banner, modal e bot√£o flutuante com total seguran√ßa de tipo.
- **Controle Simplificado do Modal**: A visibilidade do modal √© controlada exclusivamente pelo estado interno, eliminando a necessidade da prop `disableAutomaticModal`.
- **Carregamento Imediato de Banner e Bot√£o Flutuante**: Removido o lazy loading para `CookieBanner` e `FloatingPreferencesButton` para garantir visibilidade imediata e evitar falhas de carregamento.
- **Prop `disableDeveloperGuidance`**: Permite desabilitar os avisos e sugest√µes para desenvolvedores no console.
- **Prop `reloadOnChange` para `ConsentScriptLoader`**: Permite recarregar scripts de integra√ß√£o quando as prefer√™ncias de consentimento mudam.
- **Ajuste de Posi√ß√£o da Marca**: A marca "fornecido por L√âdipO.eti.br" agora √© exibida no canto inferior direito do banner e modal.

## [0.2.6] - 2025-08-12 - ESTABILIZA√á√ÉO E CONFORMIDADE

### üõ°Ô∏è **Modificado**

- **Gerenciamento de Estado Unificado**: O `ConsentProvider` foi refatorado para usar uma l√≥gica centralizada (`categoryUtils.ts`) para criar e validar as prefer√™ncias de consentimento. Isso elimina inconsist√™ncias e garante que o estado do consentimento sempre reflita a configura√ß√£o do projeto (`ProjectCategoriesConfig`).
- **Valida√ß√£o na Hidrata√ß√£o**: Ao carregar o estado de um cookie existente, as prefer√™ncias agora s√£o validadas contra a configura√ß√£o atual do projeto. Categorias que n√£o existem mais na configura√ß√£o s√£o removidas, evitando estados inv√°lidos.

### ‚ú® **Adicionado**

- **Metadados de Auditoria no Cookie**: O cookie de consentimento agora armazena um snapshot da configura√ß√£o de categorias (`projectConfig`) que estava ativa no momento em que o consentimento foi dado. Isso fortalece a capacidade de auditoria e a conformidade com a LGPD.

### üìö **Documenta√ß√£o**

- **Consolida√ß√£o**: A pasta `docs` foi significativamente limpa, com a remo√ß√£o de m√∫ltiplos arquivos redundantes e tempor√°rios.
- **README.md Melhorado**: O arquivo `README.md` principal foi completamente reescrito para seguir um padr√£o profissional, com estrutura clara, exemplos de c√≥digo atualizados e badges de status do projeto.
- **Guia de Conformidade Unificado**: O arquivo `COMPLIANCE.md` agora centraliza as informa√ß√µes sobre as funcionalidades de conformidade da biblioteca e as orienta√ß√µes para desenvolvedores, incorporando conte√∫do de outros documentos que foram removidos.

### üêõ **Corrigido**

- **Consist√™ncia do Consentimento**: Corrigido o problema onde as a√ß√µes `ACCEPT_ALL` e `REJECT_ALL` n√£o consideravam a configura√ß√£o completa do projeto, podendo levar a um estado de prefer√™ncias incorreto.

## [0.2.2] - 2025-08-12 - SISTEMA DE ORIENTA√á√ïES PARA DESENVOLVEDORES

### ‚ú® **Adicionado**

#### **üö® Sistema Inteligente de Orienta√ß√µes**

- **Console de Desenvolvimento**: Avisos autom√°ticos sobre configura√ß√£o
  - ‚ö†Ô∏è **Avisos**: Detecta configura√ß√£o faltante, inconsistente ou problem√°tica
  - üí° **Sugest√µes**: Recomenda√ß√µes para melhor compliance e UX
  - üîß **Tabela de Categorias**: Lista categorias ativas para orientar UI customizada

- **Novos Hooks para Componentes Customizados**:
  - `useCategories()`: Informa√ß√µes completas sobre categorias ativas no projeto
  - `useCategoryStatus(id)`: Verifica se categoria espec√≠fica est√° configurada
  - **Preven√ß√£o de Bugs**: Evita inconsist√™ncias entre configura√ß√£o e UI

#### **üé® UI Din√¢mica e Inteligente**

- **PreferencesModal Aprimorado**: Renderiza automaticamente apenas categorias configuradas
- **Componentes Adaptativos**: UI se ajusta dinamicamente √† configura√ß√£o do projeto
- **Renderiza√ß√£o Condicional**: N√£o exibe categorias n√£o utilizadas no projeto

#### **üìã Configura√ß√£o Padr√£o Defensiva**

- **Padr√£o Inteligente**: Quando nenhuma categoria especificada, usa `necessary + analytics`
- **Orienta√ß√£o Autom√°tica**: Avisa sobre uso de configura√ß√£o padr√£o em desenvolvimento
- **Migra√ß√£o Transparente**: API de categorias funciona perfeitamente

#### **üîç An√°lise e Valida√ß√£o de Configura√ß√£o**

- **Fun√ß√£o `analyzeDeveloperConfiguration()`**: Valida e orienta sobre configura√ß√£o
- **Constante `DEFAULT_PROJECT_CATEGORIES`**: Configura√ß√£o padr√£o baseada em casos reais
- **Detec√ß√£o Autom√°tica**: Identifica muitas categorias, descri√ß√µes inadequadas, etc.

### üîß **Modificado**

#### **ConsentProvider Expandido**

- **Suporte Completo**: Prop `categories` com configura√ß√£o de categorias padr√£o e personalizadas
- **Sistema de Orienta√ß√µes**: Log autom√°tico de orienta√ß√µes em modo desenvolvimento
- **Configura√ß√£o Moderna**: Nova estrutura da prop `categories` para maior flexibilidade

#### **Componentes UI Inteligentes**

- **Inicializa√ß√£o Segura**: `tempPreferences` inicializado corretamente com valores padr√£o
- **Sincroniza√ß√£o Din√¢mica**: Estado local sincroniza apenas com categorias ativas
- **Renderiza√ß√£o Otimizada**: Loops baseados em `toggleableCategories` ao inv√©s de hardcode

### üêõ **Corrigido**

- **React Warning**: Eliminado "A component is changing an uncontrolled input to be controlled"
- **Estado de Input**: `PreferencesModal` inicializa switches com valores controlados
- **Sincroniza√ß√£o**: Prefer√™ncias tempor√°rias sincronizam corretamente com categorias ativas
- **Performance**: N√£o renderiza componentes para categorias n√£o configuradas

### üìö **Documenta√ß√£o**

- **Novo arquivo**: `docs/ORIENTACOES-DESENVOLVIMENTO.md` - Guia completo do sistema
- **README expandido**: Exemplos pr√°ticos da nova API e componentes din√¢micos
- **Exemplos de uso**: Demonstra√ß√£o de hooks para valida√ß√£o condicional de categorias
- **Guias de migra√ß√£o**: Como usar nova API mantendo compatibilidade

### üéØ **Benef√≠cios da v0.2.2**

#### **Para Desenvolvedores**

- üö® **Orienta√ß√£o Proativa**: Console indica exatamente quais categorias implementar na UI
- üêõ **Preven√ß√£o de Bugs**: Valida√ß√£o autom√°tica de consist√™ncia Configura√ß√£o ‚Üî UI
- üîß **Flexibilidade Total**: APIs antigas funcionam, nova API oferece mais controle
- üìã **TypeScript Completo**: Tipos espec√≠ficos para cada hook e configura√ß√£o

#### **Para Compliance LGPD**

- üéØ **Configura√ß√£o Consciente**: Sistema for√ßa reflex√£o sobre quais dados realmente coletar
- üìù **Documenta√ß√£o Autom√°tica**: Orienta√ß√µes baseadas na configura√ß√£o real do projeto
- üîç **Auditabilidade**: Logs claros mostram decis√µes de configura√ß√£o
- üõ°Ô∏è **Conformidade Ativa**: Alinhamento din√¢mico com princ√≠pios da ANPD

#### **Para Usu√°rios Finais**

- ‚ö° **Performance Superior**: Interface otimizada mostra apenas categorias relevantes
- üéØ **Experi√™ncia Focada**: Usu√°rios n√£o veem op√ß√µes irrelevantes para o projeto
- üîí **Transpar√™ncia M√°xima**: Descri√ß√µes claras apenas de categorias realmente utilizadas

---

## [0.2.1] - 2025-08-12 - CONFORMIDADE LGPD RIGOROSA + SISTEMA DE ORIENTA√á√ïES

### üö® **NOVO: Sistema de Orienta√ß√µes para Desenvolvedores**

A v0.2.1 introduz um **sistema inteligente de orienta√ß√µes** que guia desenvolvedores sobre configura√ß√£o adequada e previne inconsist√™ncias entre configura√ß√£o e UI customizada.

### üõ°Ô∏è **BREAKING CHANGES - Conformidade ANPD**

#### **Cookie de Consentimento Reestruturado**

- **üç™ Estrutura do Cookie**: Novo formato com campos obrigat√≥rios para compliance
  - `version`: Controle de migra√ß√£o de schema
  - `consentDate`: Timestamp da primeira intera√ß√£o
  - `lastUpdate`: Timestamp da √∫ltima modifica√ß√£o
  - `source`: Origem da decis√£o (`banner`, `modal`, `programmatic`)
  - **Removido**: `isModalOpen` (estado de UI n√£o deve ser persistido)

#### **Sistema de Categorias por Projeto**

- **üîß Nova Prop**: `categories` no `ConsentProvider` para especificar apenas categorias ativas
- **üì¶ Principio da Minimiza√ß√£o**: Cookie cont√©m apenas categorias realmente utilizadas
- **‚ö° Performance**: Redu√ß√£o significativa do tamanho do cookie

### ‚ú® **Adicionado**

#### **Configura√ß√£o de Categorias Ativas**

```tsx
<ConsentProvider
  categories={{
    enabledCategories: ['analytics', 'functional'], // Apenas essas + necessary
  }}
>
```

#### **Comportamento LGPD Rigoroso**

- **üö´ Banner Bloqueante**: Prop `blocking={true}` para exigir decis√£o expl√≠cita
- **üìµ Padr√£o "Rejeitar Todos"**: Conformidade com interpreta√ß√£o rigorosa da LGPD
- **‚è∞ Timestamps Autom√°ticos**: Auditoria completa de intera√ß√µes

#### **Utilit√°rios de Compliance**

- **üîß `validateCategoriesConfig()`**: Valida√ß√£o de configura√ß√£o de categorias
- **üìä `createProjectPreferences()`**: Gera√ß√£o de prefer√™ncias baseada na config
- **üßπ Migra√ß√£o Autom√°tica**: Cookies v0.2.0 migrados automaticamente

### üîß **Corrigido**

- **README.md**: Badges duplicados e links quebrados corrigidos
- **TypeScript**: Tipos mais rigorosos para `ConsentState` e `ConsentCookieData`
- **Cookie Utils**: Separa√ß√£o clara entre dados persistidos e estado de UI
- **Conformidade**: Remo√ß√£o autom√°tica de campos n√£o-compliance do cookie

### üìã **Documenta√ß√£o**

- **üìã CONFORMIDADE.md**: Guia completo de implementa√ß√£o conforme ANPD
- **üîÑ Migra√ß√£o**: Instru√ß√µes detalhadas v0.2.0 ‚Üí v0.2.1
- **üèõÔ∏è Exemplos**: Casos de uso governamentais e corporativos

### ‚ö†Ô∏è **Migra√ß√£o v0.2.0 ‚Üí v0.2.1**

#### **Autom√°tica (Recomendada)**

- Cookies existentes migrados automaticamente
- API v0.2.0 mant√©m compatibilidade

#### **Manual (Para M√°xima Conformidade)**

```tsx
// Especificar apenas categorias necess√°rias
<ConsentProvider
  categories={{ enabledCategories: ['analytics'] }}
  blocking={true} // Para compliance rigorosa
>
```

### üìä **Impacto**

- **üì¶ Bundle Size**: Mantido (~11KB ESM)
- **üîÑ Backward Compatibility**: 95% (quebras apenas em casos edge)
- **üõ°Ô∏è Compliance**: 100% LGPD/ANPD conforme Guia Orientativo
- **‚ö° Performance**: Cookies at√© 70% menores em projetos t√≠picos

## [0.2.0] - 2025-08-12

### üéâ MAJOR UPDATE - Adequa√ß√£o ANPD Completa

### ‚ú® Adicionado

- **üç™ Categorias ANPD Expandidas**: Sistema baseado no Guia Orientativo da ANPD
  - `necessary`: Cookies essenciais (sempre ativos)
  - `analytics`: An√°lise e estat√≠sticas
  - `functional`: Funcionalidades extras
  - `marketing`: Publicidade e marketing
  - `social`: Integra√ß√£o com redes sociais
  - `personalization`: Personaliza√ß√£o de conte√∫do

- **üîß Sistema de Categorias Flex√≠vel**
  - Nova interface `CategoryDefinition` para defini√ß√µes de categorias
  - Suporte a categorias essenciais vs opcionais
  - Prop `categories` com configura√ß√£o granular

- **üìù Textos ANPD Expandidos** (todos opcionais para backward compatibility)
  - `controllerInfo`: Identifica√ß√£o do controlador dos dados
  - `dataTypes`: Tipos de dados coletados
  - `thirdPartySharing`: Compartilhamento com terceiros
  - `userRights`: Direitos do titular dos dados
  - `contactInfo`: Contato do DPO/respons√°vel
  - `retentionPeriod`: Prazo de armazenamento
  - `lawfulBasis`: Base legal (consentimento/interesse leg√≠timo)
  - `transferCountries`: Pa√≠ses de transfer√™ncia internacional

- **üöÄ Integra√ß√µes Nativas de Scripts**
  - `createGoogleAnalyticsIntegration()`: GA4 configurado automaticamente
  - `createGoogleTagManagerIntegration()`: GTM configurado automaticamente
  - `createUserWayIntegration()`: UserWay para acessibilidade
  - `ConsentScriptLoader`: Componente para carregamento autom√°tico
  - `useConsentScriptLoader`: Hook para carregamento program√°tico
  - Interface `ScriptIntegration` para scripts customizados

- **üéõÔ∏è Sistema de Categorias Din√¢mico**
  - Context `CategoriesProvider` separado para melhor organiza√ß√£o
  - Prefer√™ncias expandidas com suporte a `[key: string]: boolean`
  - Reducer atualizado para categorias customizadas

### üîß Melhorado

- **Prefer√™ncias padr√£o**: Agora incluem todas as 6 categorias ANPD
- **Tipagem expandida**: `Category` type agora inclui todas as categorias
- **Context arquitetura**: Separa√ß√£o de responsabilidades mais clara
- **Documenta√ß√£o**: Guias detalhados para cada nova funcionalidade

### üì¶ Interno

- Context `CategoriesCtx` para categorias customizadas
- Fun√ß√£o `createInitialPreferences()` para inicializa√ß√£o din√¢mica
- Reducer com suporte a a√ß√µes com categorias customizadas
- Exports expandidos no `index.ts`

### üéØ Compatibilidade

- ‚úÖ **100% Backward Compatible**: Todas as APIs existentes funcionam
- ‚úÖ **Opt-in Features**: Novas funcionalidades s√£o opcionais
- ‚úÖ **Progressive Enhancement**: Funciona do simples ao complexo

### üìä Bundle Size

- **Antes**: 6.65 KB ESM + 14.08 KB chunk
- **Agora**: 10.84 KB ESM + 15.90 KB chunk
- **Crescimento**: +4.19 KB (+64% de funcionalidades)

## [0.1.3] - 2025-08-09

### üéâ Adicionado

- **Banner bloqueante**: Nova prop `blocking` no `CookieBanner` (padr√£o: `true`)
  - Quando `blocking=true`, exibe overlay escuro que impede intera√ß√£o at√© decis√£o
  - Quando `blocking=false`, usa o comportamento Snackbar n√£o intrusivo
- **Sistema de temas**: Suporte completo a temas Material-UI
  - Tema padr√£o institucional (`defaultConsentTheme`) baseado nas cores da ANPD
  - Prop `theme` no `ConsentProvider` para temas customizados
  - ThemeProvider autom√°tico para todos os componentes filhos
- **Modal de prefer√™ncias funcional**:
  - Estado `isModalOpen` agora conectado ao contexto
  - Bot√£o "Prefer√™ncias" no banner abre corretamente o modal
  - Hook `useConsent()` exp√µe `isModalOpen`
- **Script loader aprimorado**:
  - Nova fun√ß√£o `loadConditionalScript()` que aguarda consentimento
  - Callbacks com delay de 150ms para permitir anima√ß√µes de fechamento
  - Melhor integra√ß√£o com `ConsentGate`
- **Hook adicional**: `useConsentTexts()` para acessar textos customizados

### üîß Corrigido

- **Textos customizados**: Props `texts` do `ConsentProvider` agora funcionam corretamente
  - Componentes `CookieBanner` e `PreferencesModal` usam textos do contexto
  - Remo√ß√£o da depend√™ncia direta de `defaultTexts`
- **Estado do modal**: `isModalOpen` integrado ao reducer e hooks
- **Conex√£o de a√ß√µes**: Todas as a√ß√µes (`openPreferences`, `closePreferences`, etc.) funcionais

### üì¶ Interno

- Context `TextsCtx` para disponibilizar textos customizados
- Reducer atualizado com estado `isModalOpen`
- ThemeProvider integrado ao ConsentProvider
- Delays nos callbacks para melhor UX

### üé® Design

- Banner bloqueante com overlay `rgba(0, 0, 0, 0.5)`
- zIndex 1300 (acima de modais MUI)
- Tema padr√£o com bordas arredondadas e sombras suaves
- Transi√ß√µes suaves para melhor experi√™ncia visual

## [0.1.0] - 2025-08-09

### üéâ Lan√ßamento Inicial

- **Contexto de consentimento** com `ConsentProvider`
- **Banner b√°sico** com bot√µes Aceitar/Recusar/Prefer√™ncias
- **Modal de prefer√™ncias** para categorias analytics e marketing
- **Hook `useConsent()`** para intera√ß√£o com estado
- **Componente `ConsentGate`** para renderiza√ß√£o condicional
- **Utilit√°rios**:
  - `loadScript()` para carregamento din√¢mico de scripts
  - `cookieUtils` para persist√™ncia
- **Suporte SSR** via prop `initialState`
- **Acessibilidade** com ARIA e navega√ß√£o por teclado
- **TypeScript** completo com tipos exportados

### üèóÔ∏è Arquitetura

- Context API com reducer pattern
- Cookies seguros (`SameSite=Lax`, `secure=true`)
- API p√∫blica em ingl√™s, UI padr√£o em portugu√™s
- Zero depend√™ncias extras (apenas `js-cookie`)

---

### üîÆ Futuro (v0.4.0+)

- [ ] Modal detalhado com lista de cookies
- [ ] Base legal por categoria
- [ ] Relat√≥rios de compliance
- [ ] Templates por setor

## [0.4.2] - 06/10/2025 ‚Äî Quickstarts + SSR Guide + Valida√ß√£o (DEV)

### ‚ú® Quickstarts execut√°veis

- Next.js (App Router) e Vite com Consent Mode v2 integrado e bloqueio real de scripts (GTM/GA4 n√£o carregam antes do consentimento).
- Se√ß√µes no QUICKSTART.md com passos copy‚Äëpaste e valida√ß√£o do comportamento esperado.

### üß± Guia SSR/Next.js (App Router)

- Padr√µes seguros para evitar hydration mismatch: wrapper client‚Äëonly com `'use client'` e `dynamic({ ssr: false })`, efeitos que acessam `window/document` apenas no cliente.
- Ordem de provedores/estilos (Emotion/MUI) e z-index/portals documentados (overlay 1299, modais ‚â• 1300).

### ‚úÖ Valida√ß√£o de configura√ß√£o do ConsentProvider (DEV)

- Valida√ß√£o com Zod em desenvolvimento (import din√¢mico) e sanitiza√ß√£o leve em produ√ß√£o.
- Mensagens amig√°veis: alerta quando `categories` n√£o √© fornecida; remove `'necessary'` de `enabledCategories`; detecta duplicidades/valores inv√°lidos; valida `customCategories`.
- Testes cobrindo casos inv√°lidos e asserts de mensagens.

### üìö Categorias ‚Äî defini√ß√£o, uso e exemplos

- Fonte √∫nica de verdade: `ConsentProvider.categories`. UI, hooks e integra√ß√µes leem a mesma defini√ß√£o.
- Esclarecimento: apenas ‚Äúnecess√°rios‚Äù √© obrigat√≥rio; demais categorias s√£o opcionais conforme o neg√≥cio.
- Exemplos m√≠nimo (somente necess√°rios) e completo (analytics/marketing/functional).

### üîß Depend√™ncias

- Adicionado: `zod@^3.23.8` (usado somente em DEV via import din√¢mico; n√£o impacta o bundle de produ√ß√£o).

### üß© Sem breaking changes

- Altera√ß√µes s√£o compat√≠veis; padr√µes seguros preservados.
## [0.5.0] - 25/10/2025 ‚Äî Modulariza√ß√£o inicial do workspace

### üß± Estrutura modular
- Reposit√≥rio convertido em workspace PNPM com tr√™s pacotes: `@react-lgpd-consent/core`, `@react-lgpd-consent/mui` e `react-lgpd-consent`.
- Pacote agregador passa a construir entradas adicionais (`core` e `mui`) expondo subpath exports oficiais.

### üé® Camada MUI dedicada
- Publica√ß√£o inicial de `@react-lgpd-consent/mui` como _proxy_ dos componentes padr√£o.
- Metadados de peer dependencies ajustados para refor√ßar que Material-UI √© opcional (requerido apenas para a camada visual).

### üß∞ Ferramentas & DX
- Scripts de lint/test/build convertidos para `pnpm --filter react-lgpd-consent <comando>`.
- Jest e TypeDoc atualizados para apontar para `packages/core` e `packages/react-lgpd-consent`.
- Documenta√ß√£o (README, QUICKSTART, DEVELOPMENT) revisada para explicar a nova arquitetura e o processo de migra√ß√£o gradual.
